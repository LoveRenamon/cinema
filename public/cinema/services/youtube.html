<!DOCTYPE html>
<html>

<body style="margin: 0px; background-color: black; overflow: hidden">
    <div id="player"></div>
    <script>
        var query = new URL(location.href).searchParams;
        var videoID = query.get("v") || "dQw4w9WgXcQ";
        var startTime = query.get("t") || 0;

        var tag = document.createElement("script");
        tag.src = "https://www.youtube.com/iframe_api";

        var firstScriptTag = document.getElementsByTagName("script")[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        var video, playing = false;
        function onYouTubeIframeAPIReady() {
            video = new YT.Player("player", {
                height: window.innerHeight,
                width: window.innerWidth,
                videoId: videoID,
                wmode: "transparent",
                host: "https://www.youtube-nocookie.com", //GDPR Friendly
                playerVars: {
                    start: parseInt(startTime),
                    autoplay: 1,
                    controls: 0,
                    showinfo: 0,
                    modestbranding: 1,
                    disablekb: 0,
                    mute: 1,
                    rel: 0,
                    wmode: "transparent",
                    iv_load_policy: 3, // hide annotations
                    origin: location.origin,
                },
                events: {
                    onReady: onPlayerReady,
                },
            });
        }

        function onPlayerReady(event) {
            video.addEventListener("onStateChange", onPlayerStateChange);
        }

        function onPlayerStateChange(event) {
            if (event.data == YT.PlayerState.PLAYING && !playing) {
                playing = true;

                event.target.setPlaybackQuality("medium");
                event.target.volume = 0;
                event.target.currentTime = 0;
                event.target.duration = event.target.getDuration();

                Object.defineProperty(event.target, "volume", {
                    get() {
                        return event.target.getVolume();
                    },
                    set(volume) {
                        if (event.target.isMuted()) {
                            event.target.unMute();
                        }
                        event.target.setVolume(volume * 100);
                    },
                });

                Object.defineProperty(event.target, "currentTime", {
                    get() {
                        return Number(event.target.getCurrentTime());
                    },
                    set(time) {
                        event.target.seekTo(time);
                    },
                });

                //Use Theater Controller
                window.player = video;
                console.log("INTERFACE_START");
            }
        }
    </script>
</body>

</html>